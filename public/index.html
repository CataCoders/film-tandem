<!DOCTYPE html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <style>
      * {
        box-sizing: border-box;
      }

      *::after {
        box-sizing: border-box;
      }

      *::before {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
      }

      .app {
        width: 100vw;
        height: 100vh;

        display: flex;
        flex-direction: column;
      }

      .movie-stack {
        position: relative;

        flex-grow: 1;
      }

      .movie-stack > img {
        position: absolute;
        height: 100%;
        left: 50%;
        transform: translateX(-50%);
      }
    </style>
  </head>
  <body>
    <main class="app">
      <div class="movie-stack" id="movie-list"></div>
      
      <div class="swipe-buttons">
        <button id="dislike">Dislike</button>
        <button id="like">Like</button>
      </div>
    </main>

    <script src="/socket.io/socket.io.js"></script>

    <script>
      var socket = io();

      var messages = document.getElementById("messages");
      var form = document.getElementById("form");
      const movieListEl = document.getElementById("movie-list");
      const likeButton = document.getElementById("like");
      const dislikeButton = document.getElementById("dislike");

      dislikeButton.addEventListener("click", function (e) {
        socket.emit("movie.dislike", prompt());
      });

      likeButton.addEventListener("click", function (e) {
        socket.emit("movie.like", prompt());
      });

      function renderNewMovies(newMovies) {
        for (const movie of newMovies) {
          const movieElement = document.createElement("img");
          movieElement.src = movie.posterUrl;

          movieListEl.appendChild(movieElement);
        }
      }

      socket.on("movie.list", function (movieListSerialized) {
        const newMovieList = JSON.parse(movieListSerialized);
        renderNewMovies(newMovieList);
      });

      socket.on("movie.match", function (movieId) {
        alert("its a match: " + movieId);
      });
    </script>
  </body>
</html>
